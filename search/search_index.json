{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Silverreed Firmware Documentation","text":"<p>Open-source firmware for automating Silver Reed knitting machines using Arduino and the AYAB protocol.</p>"},{"location":"#overview","title":"Overview","text":"<p>A modern, open-source solution for programming patterns on Silver Reed electronic knitting machines.</p> <p>Key Features: - Arduino UNO / UNO R4 WiFi support - AYAB Protocol v6 implementation - Real-time control - Full hardware and software documentation</p>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>git clone https://github.com/MathKnitting/silverreed-firmware.git\ncd silverreed-firmware\ncurl -LsSf https://astral.sh/uv/install.sh | sh\nuv sync --all-groups\nuv run task init\nuv run task build &amp;&amp; uv run task upload\n</code></pre> <p>See Installation Guide for details.</p>"},{"location":"#documentation-sections","title":"Documentation Sections","text":"<p>Getting Started Installation, building, and uploading firmware</p> <p>Concepts Project purpose and how knitting machines work</p> <p>Hardware Shield design, pin mapping, and connections</p> <p>Firmware Architecture, components, and implementation</p> <p>Development Testing, debugging, and contributing</p>"},{"location":"#technology-used","title":"Technology used","text":"<ul> <li>Platform: Arduino UNO / UNO R4 WiFi</li> <li>Language: C++11</li> <li>Build: PlatformIO + uv + taskipy</li> <li>Protocol: AYAB v6 with SLIP encoding</li> <li>Testing: Unity + simavr</li> <li>Board Design: Kicad 6</li> </ul>"},{"location":"#contributing","title":"Contributing","text":"<p>Contributions welcome! Report issues or submit PRs on GitHub.</p>"},{"location":"#license","title":"License","text":"<p>MIT License - see LICENSE</p>"},{"location":"concepts/ayab-protocol/","title":"AYAB Protocol","text":""},{"location":"concepts/ayab-protocol/#protocol-documentation","title":"Protocol Documentation","text":"<p>For complete protocol specifications, message formats, and API details, refer to the official AYAB documentation:</p> <p>AYAB API Documentation</p> <p>The official documentation covers: - Message structure and encoding - Complete command reference (reqStart, cnfLine, indState, etc.) - Error handling and status codes - Communication flow and timing requirements - Integration examples</p>"},{"location":"concepts/ayab-protocol/#implementation-in-this-firmware","title":"Implementation in This Firmware","text":"<p>The AYAB protocol is implemented in the communication layer:</p> <ul> <li>ayab.h / ayab.cpp - Protocol implementation</li> <li>Uses PacketSerial library for SLIP encoding</li> </ul>"},{"location":"concepts/knitting-machines/","title":"How Silver Reed Knitting Machines Work","text":""},{"location":"concepts/knitting-machines/#introduction-to-knitting-machines","title":"Introduction to Knitting Machines","text":"<p>Silver Reed knitting machines are domestic machines designed in the 1980s-1990s. They allow knitting pieces much faster than hand knitting.</p>"},{"location":"concepts/knitting-machines/#main-components","title":"Main Components","text":""},{"location":"concepts/knitting-machines/#the-carriage","title":"The Carriage","text":"<p>The carriage is the moving part that travels left to right across the needle bed. It:</p> <ul> <li>Forms stitches by pulling yarn through loops</li> <li>Selects which needles should knit</li> <li>Detects its position and direction using sensors</li> </ul> <p>Key difference from Brother machines: On Silver Reed machines, the carriage contains all the patterning logic: - Sensors send information to the \"patterning brain\" inside the carriage - Solenoids (electromagnets) act on selected needles to either select or skip them</p>"},{"location":"concepts/knitting-machines/#the-needle-bed","title":"The Needle Bed","text":"<p>The bed contains 200 needles numbered sequentially. Each needle can be in different positions:</p> <ul> <li>Position A (back): the needle knits</li> <li>Position B (forward): the needle is in hold</li> <li>Position D (very forward): the needle doesn't knit (pattern)</li> </ul>"},{"location":"concepts/knitting-machines/#the-solenoids","title":"The Solenoids","text":"<p>Solenoids are electromagnets that control needle selection. The firmware activates/deactivates these solenoids to create the pattern:</p> <ul> <li>Solenoid activated: the needle knits</li> <li>Solenoid deactivated: the needle skips (doesn't knit)</li> </ul>"},{"location":"concepts/knitting-machines/#operating-principle","title":"Operating Principle","text":""},{"location":"concepts/knitting-machines/#1-carriage-movement","title":"1. Carriage Movement","text":"<p>The carriage moves manually from left to right and vice-versa. On each pass:</p> <ol> <li>The carriage detects its direction using the HOK signal (HIGH when moving from right to left)</li> <li>It detects needle positions using the CCP signal (Carriage Clock Pulse) - one CCP period equals one needle</li> <li>For each needle, the DOB state (Data Out Buffer) selects or skips the needle</li> </ol>"},{"location":"concepts/knitting-machines/#2-needle-selection","title":"2. Needle Selection","text":"<p>For each carriage pass:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Carriage moves \u2192                           \u2502\n\u2502                                              \u2502\n\u2502  CCP: \u2510  \u2510  \u2510  \u2510  \u2510  \u2510   (1 pulse/needle)  \u2502\n\u2502       \u2514\u2500\u2500\u2518  \u2514\u2500\u2500\u2518  \u2514\u2500\u2500\u2518                       \u2502\n\u2502                                              \u2502\n\u2502  DOB: \u2500\u2500\u2510     \u2510  \u2510     (1=knit, 0=skip)     \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500                      \u2502\n\u2502                                              \u2502\n\u2502  Result: \u25a0  \u25a1  \u25a0  \u25a0  \u25a1  (knitted pattern)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"concepts/knitting-machines/#3-electronic-signals","title":"3. Electronic Signals","text":"<p>The machine uses a 7-pin circular DIN connector to interface with the electronics:</p> <pre><code>DIN-7 Connector Pinout (front view, looking at female socket):\n\n        2\n    4       5\n  1           3\n    6       7\n</code></pre> <p>The firmware reads and controls several signals:</p> DIN Pin Signal Type Direction Description 1 ND1 Digital Input Pattern position (not used) 2 KSL Digital Input Point CAM detection - detects sections 3 DOB Digital Output Data Out Buffer - controls the needle 4 CCP Digital Input Clock Pulse - counts needles 5 HOK Digital Input Carriage direction (LEFT/RIGHT) 6 5V Power Supply Global power supply (5V) 7 16V Power Supply Solenoid power supply (16V) 8 GND Ground Common Common ground"},{"location":"concepts/knitting-machines/#technical-details","title":"Technical Details","text":""},{"location":"concepts/knitting-machines/#direction-detection","title":"Direction Detection","text":"<p>The HOK signal (Hall Sensor) indicates direction:</p> <ul> <li><code>HOK = HIGH</code>: carriage moving left \u2190</li> <li><code>HOK = LOW</code>: carriage moving right \u2192</li> </ul> <p>The firmware reverses the pattern reading order based on direction.</p>"},{"location":"concepts/knitting-machines/#pattern-zones-sections","title":"Pattern Zones (Sections)","text":"<p>The KSL signal detects pattern sections based on Point CAMs (magnets) placed on the needle bed:</p> <pre><code>Needle Bed with Point CAMs:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  [CAM]                        [CAM]   \u2502  Point CAMs (magnets)\n\u2502\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n\n\nKSL Signal:\n         Pattern Zone (between CAMs)\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\nKSL: \u2500\u2500\u2500\u2500\u2518                  \u2514\u2500\u2500\u2500\u2500\n    LOW                         LOW\n</code></pre> <ul> <li><code>KSL = HIGH</code>: Carriage is between the pattern CAMs (knitting pattern zone)</li> <li><code>KSL = LOW</code>: Carriage is outside pattern zone</li> </ul> <p>This allows the firmware to know when to activate pattern selection and optimize communication by only transferring data for the active zone.</p>"},{"location":"concepts/purpose/","title":"Project Purpose","text":""},{"location":"concepts/purpose/#overview","title":"Overview","text":"<p>The Silverreed Firmware project is an open-source firmware for Silver Reed electronic knitting machines. It enables computerized pattern creation and knitting, similar to what's available for Brother machines through the AYAB protocol.</p>"},{"location":"concepts/purpose/#why-this-project","title":"Why This Project?","text":"<p>While solutions exist for Silver Reed machines (SilverKnit + DAK, PC-10, EC-1), they have significant limitations:</p> <ul> <li>Expensive: Proprietary hardware and software</li> <li>Limited availability: Hard to find, often discontinued</li> <li>Closed source: Cannot be modified or improved by the community</li> <li>Platform restrictions: Often Windows-only</li> </ul> <p>This project provides an affordable, accessible, and open alternative based on Arduino and standard electronic components.</p>"},{"location":"concepts/purpose/#comparison-with-existing-solutions","title":"Comparison with Existing Solutions","text":"Feature Silverreed Firmware SilverKnit/DAK PC-10/EC-1 Cost ~$30 (Arduino + components) $200-500+ + DAK license $100-300+ Availability DIY (open hardware) Limited stock at resellers Used market only Platform Windows/Mac/Linux Windows only Standalone (no PC) Open Source Yes No No Community Support Active development Limited None Modifiable Full access to code/hardware Proprietary Closed hardware Protocol AYAB v6 (Brother-compatible) Proprietary Standalone device"},{"location":"concepts/purpose/#main-objectives","title":"Main Objectives","text":""},{"location":"concepts/purpose/#1-knitting-automation","title":"1. Knitting Automation","text":"<p>The firmware automates the needle selection process on Silver Reed knitting machines. Instead of manually selecting each needle according to a paper pattern, the machine receives instructions directly from a computer.</p>"},{"location":"concepts/purpose/#2-ayab-protocol-implementation","title":"2. AYAB Protocol Implementation","text":"<p>The project implements the AYAB (All Yarns Are Beautiful) protocol, an open standard for communication between computers and knitting machines. This enables:</p> <ul> <li>Compatibility with existing AYAB software</li> <li>Pattern creation with modern graphical tools</li> <li>Integration with digital design workflows</li> </ul>"},{"location":"concepts/purpose/#3-open-source-and-accessible","title":"3. Open Source and Accessible","text":"<p>As an open-source project, the firmware aims to:</p> <ul> <li>Make automated knitting technology accessible to everyone</li> <li>Allow makers and knitters to modernize their existing machines</li> <li>Create a community around digital knitting</li> </ul>"},{"location":"firmware/architecture/","title":"Firmware Architecture","text":""},{"location":"firmware/architecture/#overview","title":"Overview","text":"<p>The Silverreed firmware is designed with a layered architecture that clearly separates responsibilities:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         User Application                    \u2502\n\u2502         (AYAB Desktop, etc.)                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502 Serial + SLIP\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      Communication Layer (AYAB)             \u2502\n\u2502      - AYAB protocol v6                     \u2502\n\u2502      - SLIP encoding                        \u2502\n\u2502      - CRC8 validation                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502 Internal API\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   State Machine (KnittingProcess)          \u2502\n\u2502   - Idle / WaitingStart / Knitting         \u2502\n\u2502   - Pattern management                      \u2502\n\u2502   - Knitting coordination                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502 Commands\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    Hardware Interface (Carriage)           \u2502\n\u2502    - Sensor reading                        \u2502\n\u2502    - Solenoid control                      \u2502\n\u2502    - Position detection                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"firmware/architecture/#data-flow","title":"Data Flow","text":""},{"location":"firmware/architecture/#starting-a-session","title":"Starting a Session","text":"<pre><code>1. User: Starts knitting in AYAB Desktop\n2. AYAB Desktop \u2192 Arduino: reqStart(start=50, end=150, ...)\n3. Arduino \u2192 AYAB Desktop: cnfStart(success=true)\n4. Arduino \u2192 AYAB Desktop: reqLine(line=0)\n5. AYAB Desktop \u2192 Arduino: cnfLine(line=0, data=[...])\n6. Arduino: Waiting for carriage...\n</code></pre>"},{"location":"firmware/architecture/#knitting-a-line","title":"Knitting a Line","text":"<pre><code>1. Carriage starts: CarriageState detects movement\n2. For each needle (CCP interrupt):\n   - Read Pattern.get_pixel(needle)\n   - Carriage.set_dob(pixel_value)\n   - Wait for next CCP\n3. Line complete: reqLine(line+1)\n4. Receive new line: cnfLine(...)\n5. Repeat for next line\n</code></pre>"},{"location":"hardware/pin-mapping/","title":"Arduino Pin Configuration","text":"<p>This page describes in detail the correspondence between Arduino pins and Silver Reed knitting machine signals.</p>"},{"location":"hardware/pin-mapping/#overview","title":"Overview","text":"<p>The firmware uses 7 pins to interface the Arduino with the knitting machine:</p> <pre><code>Arduino UNO\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                \u2502\n\u2502  D2  \u25cf\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 ND1 (not used)\n\u2502  D3  \u25cf\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 KSL (Point CAM)\n\u2502  D4  \u25cf\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 DOB \u2192 Solenoid Drivers\n\u2502  D5  \u25cf\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 CCP (Interrupt)\n\u2502  D6  \u25cf\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 HOK (Direction)\n\u2502  D7  \u25cf\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 SOLENOID_POWER \u2192 Relay\n\u2502                \u2502\n\u2502  GND \u25cf\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Common ground\n\u2502  5V  \u25cf\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Logic power\n\u2502                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nConnectors to Silver Reed machine:\n  - ND1, KSL, CCP, HOK: Sensor reading (3.3V/5V)\n  - DOB: Solenoid control (logic output)\n  - SOLENOID_POWER: Power command (via Relay)\n</code></pre>"},{"location":"hardware/pin-mapping/#code-configuration","title":"Code Configuration","text":"<p>All pin configuration is centralized in lib/silverreed/src/config.h:</p>"},{"location":"hardware/pin-mapping/#board-compatibility","title":"Board Compatibility","text":""},{"location":"hardware/pin-mapping/#arduino-uno","title":"Arduino UNO","text":""},{"location":"hardware/shield/","title":"Arduino Shield for Silver Reed","text":"<p>This page describes the shield (interface board) that connects the Arduino to the Silver Reed knitting machine.</p>"},{"location":"hardware/shield/#overview","title":"Overview","text":"<p>The Arduino shield is an electronic board that plugs onto an Arduino UNO and provides:</p> <ol> <li>Connections to the knitting machine signals</li> <li>Protection of Solenoid by controling the 16V power</li> </ol>"},{"location":"hardware/shield/#assembly","title":"Assembly","text":""},{"location":"hardware/shield/#external-connections","title":"External Connections","text":""},{"location":"hardware/shield/#to-the-machine","title":"To the Machine","text":"<p>The machine connector has 6 wires:</p> Pin Signal Suggested Color Description 1 GND Black Common ground 2 CCP Yellow Clock Pulse 3 HOK Green Direction 4 KSL Blue Point CAM 5 DOB Orange Data Out 6 ND1 Purple Not used"},{"location":"hardware/shield/#power-supply","title":"Power Supply","text":"<p>The shield requires two power supplies:</p> <ol> <li>5V logic: Provided by Arduino (via USB or jack)</li> <li>16V power: External supply for solenoids</li> <li>Voltage: 16V DC</li> </ol>"},{"location":"hardware/shield/#shield-testing","title":"Shield Testing","text":""},{"location":"hardware/shield/#design-files","title":"Design Files","text":""},{"location":"reference/references/","title":"Glossary","text":""},{"location":"reference/references/#external-resources","title":"External Resources","text":""},{"location":"reference/references/#ayab-project","title":"AYAB Project","text":"<p>AYAB - All Yarns Are Beautiful</p> <p>The AYAB project provides open-source solutions for computerized knitting machine control. This firmware implements the AYAB protocol to bring the same capabilities to Silver Reed machines.</p> <ul> <li>AYAB Desktop Software - Pattern creation and knitting control software</li> <li>AYAB API Documentation - Protocol specifications</li> <li>AYAB GitHub - Source code and development</li> </ul>"},{"location":"reference/references/#technical-documentation","title":"Technical Documentation","text":"<p>Official Silver Reed machine manuals and technical documentation:</p> <ul> <li>EC1 Manual - Silver Reed EC1 electronic controller documentation</li> <li>SK580 Manual - Silver Reed SK580 knitting machine documentation</li> </ul>"}]}